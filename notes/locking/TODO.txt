TODO for locking
================


MUST HAVE
---------

* extended structure issues:

   - add svn_lock_create(), make sure it's being used   (lundblad)

   - create svn_wc_status2_t() and svn_wc_create_status()

   - ?? create svn_wc_entry2_t() ??  or deliberately not?

   - ?? is it really necessary to cache lock info separately from entry_t?


These are in the format of

* FILENAME:LINE NUMBER
    CONTENTS OF THE LINE(S) IN QUESTION (ASSIGNED COMMITTER)
      OTHER COMMENTS


* subversion/libsvn_wc/entries.c:1734
    /* ### Rest of lock fields. */

* subversion/libsvn_wc/status.c:916
    /* ### lundblad TODO Loop over lock children for this path and add (lundblad)

* subversion/libsvn_wc/status.c:982
    /* ### lundblad TODO: Make sure lock info is added. */ (lundblad)

* subversion/libsvn_ra_local/ra_plugin.c:166
    /* ### What could go wrong here? Currently, it always succeeds. */
      (NOTE: See subversion/svnserve/serve.c:153 for how to do this)

* subversion/libsvn_ra_local/ra_plugin.c:445
    ### What about the other errors? Collecting them all could mean
    ### a lot of errors for the user. Should we just collect the first
    ### error and continue? */
* subversion/svnserve/serve.c:704
    ### What is the best thing to do with other errors (see comment
    ### libsvn_ra_local/ra_plugin.c. */
      These need to be discussed--ra_local and svnserve are just
      throwing these errors away ATM. Perhaps we could do the following:
      - mod_dav_svn: log the error in the error_log
      - svn_serve: place a TODO comment in the code that when logging 
        is implemented, this should be logged as a warning
      - ra_local: Throw a warning somehow?

* subversion/libsvn_fs_fs/lock.c:523 
    /* ### TODO:  We need the write lock here, but some callers
       ### already has it.  Also, we need to reread the lock to
       ### avoid a race.  We don't want the write lock grabbed just
       ### to get a lock. */ (cmpilato)

* in svn_wc_entry_t, rename lock_crt_date to lock_creation_date.

NICE TO HAVE
------------

* improve cmdline help messages

* put quotes around user names as well as around lock names when we error.

* possibly teach mailer.py to send lock/unlock mails (fitz)

* remove ra_svn shim for multiple locks/unlocks (fitz)

* client test cases (fitz) [broad cases done]

* get httpd 2.0.54 released, so that svn 1.2 can compile on win32

* get neon 0.25 released, so the control-c bug can go away
  (chat with jorton about neon 0.25/svn 1.2 coordination?)

* subversion/clients/cmdline/lock-cmd.c:66
    /* ### Should we do this in a loop like for the commit message? */ (lundblad)

-----------------------------------------------

* Questions:

   * Decide what should happen when unlocking in commit if an error happens.

   * how do locks relate to dump/load?  file as an enhancement? 


* Stuff to document in book:
     
       - 4 new hooks
       - 'lock' and 'unlock' commands, svn:needs-lock property.
       - svnadmin lslocks, rmlocks, lock
       - svnlook lock
       - 'svn info URL'
       - 'svn st -u' additions
       - new 'svn up' and 'svn commit' behaviors w.r.t. locktokens
       - two new bdb tables in BDB section.
       - update the description of autoversioning in appendix C!

         ### remember to update authz policy doc. 

* Autoversioning TODO:

 * propfind depth 1 on a collection should show lock-null resources.
   currently not happening.  can this be done *compatibly* with svn
   clients?

 * finish autoversioning:  see bug in issue 2161.
        --> autoversioning on win32 webfolders and MSWord ?
        --> investigate XP workaround for webfolders:
                http://www.winnetmag.com/Article/ArticleID/24478/24478.html
                http://zettai.net/Members/billfergus/1103749117/view
            IE->File->Open->URL, check 'open as webfolder'?

