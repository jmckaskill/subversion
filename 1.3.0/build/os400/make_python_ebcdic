#!/bin/sh

# QSH utility script for converting all python test scripts from utf-8 to
# ebcidc.
#
# usage: make_python_ebcdic svn_root_dir
#        Where svn_root_dir is the root directory of the subversion source
#        code tree.

ROOTDIR=$1

cd $ROOTDIR

QSH_REDIRECTION_TEXTDATA=Y

convert_file()
{
  TARGET=$1
  if attr $TARGET CCSID > /dev/null
    then
      if attr $TARGET CCSID | grep "37" > /dev/null
        then echo "Python script '$ROOTDIR/$TARGET' already encoded in ebcdic."                                           
      else
        echo "Converting script '$ROOTDIR/$TARGET' from utf-8 to ebcdic."
        cat $TARGET > $TARGET.37.py
        rm -f $TARGET
        mv $TARGET.37.py $TARGET
      fi
    else
      echo "Expected Python script '$ROOTDIR/$TARGET' not found!"
  fi
}

convert_file as400test.py
convert_file build/run_tests.py
convert_file subversion/tests/clients/cmdline/svntest/__init__.py
convert_file subversion/tests/clients/cmdline/svntest/actions.py
convert_file subversion/tests/clients/cmdline/svntest/entry.py
convert_file subversion/tests/clients/cmdline/svntest/main.py
convert_file subversion/tests/clients/cmdline/svntest/testcase.py
convert_file subversion/tests/clients/cmdline/svntest/tree.py
convert_file subversion/tests/clients/cmdline/svntest/wc.py
convert_file subversion/tests/clients/cmdline/autoprop_tests.py 
convert_file subversion/tests/clients/cmdline/basic_tests.py    
convert_file subversion/tests/clients/cmdline/blame_tests.py    
convert_file subversion/tests/clients/cmdline/cat_tests.py      
convert_file subversion/tests/clients/cmdline/commit_tests.py   
convert_file subversion/tests/clients/cmdline/copy_tests.py     
convert_file subversion/tests/clients/cmdline/diff_tests.py     
convert_file subversion/tests/clients/cmdline/ebcdic.py         
convert_file subversion/tests/clients/cmdline/export_tests.py   
convert_file subversion/tests/clients/cmdline/externals_tests.py
convert_file subversion/tests/clients/cmdline/getopt_tests.py   
convert_file subversion/tests/clients/cmdline/history_tests.py  
convert_file subversion/tests/clients/cmdline/import_tests.py    
convert_file subversion/tests/clients/cmdline/lock_tests.py      
convert_file subversion/tests/clients/cmdline/log_tests.py       
convert_file subversion/tests/clients/cmdline/merge_tests.py     
convert_file subversion/tests/clients/cmdline/prop_tests.py      
convert_file subversion/tests/clients/cmdline/revert_tests.py    
convert_file subversion/tests/clients/cmdline/schedule_tests.py  
convert_file subversion/tests/clients/cmdline/special_tests.py   
convert_file subversion/tests/clients/cmdline/stat_tests.py      
convert_file subversion/tests/clients/cmdline/svnadmin_tests.py  
convert_file subversion/tests/clients/cmdline/svnlook_tests.py   
convert_file subversion/tests/clients/cmdline/svnversion_tests.py
convert_file subversion/tests/clients/cmdline/switch_tests.py    
convert_file subversion/tests/clients/cmdline/trans_tests.py     
convert_file subversion/tests/clients/cmdline/update_tests.py    
convert_file subversion/tests/clients/cmdline/utf8_tests.py   
convert_file subversion/tests/libsvn_subr/target-test.py

exit 0